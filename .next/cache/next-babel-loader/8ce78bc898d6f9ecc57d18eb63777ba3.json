{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport React from \"react\";\nvar __jsx = React.createElement;\nimport { useRouter } from 'next/router';\nimport baseUrl from '../../helpers/baseUrl';\nimport { useRef, useEffect, useState } from 'react';\nimport { parseCookies } from 'nookies';\nimport cookie2 from 'js-cookie';\n\nvar Product = function Product(_ref) {\n  var product = _ref.product;\n\n  var _useState = useState(1),\n      quantity = _useState[0],\n      setQuantity = _useState[1];\n\n  var router = useRouter();\n  var modalRef = useRef(null);\n  var cookie = parseCookies();\n  var user = cookie.user ? JSON.parse(cookie.user) : \"\";\n  useEffect(function () {\n    M.Modal.init(modalRef.current);\n  }, []);\n\n  if (router.isFallback) {\n    return __jsx(\"h3\", null, \"loading...\");\n  }\n\n  var getModal = function getModal() {\n    return __jsx(\"div\", {\n      id: \"modal1\",\n      className: \"modal\",\n      ref: modalRef\n    }, __jsx(\"div\", {\n      className: \"modal-content\"\n    }, __jsx(\"h4\", null, product.name), __jsx(\"p\", null, \"Are you sure you want to delete this\")), __jsx(\"div\", {\n      className: \"modal-footer\"\n    }, __jsx(\"button\", {\n      className: \"btn waves-effect waves-light #1565c0 blue darken-3\"\n    }, \"cancel\"), __jsx(\"button\", {\n      className: \"btn waves-effect waves-light #c62828 red darken-3\",\n      onClick: function onClick() {\n        return deleteProduct();\n      }\n    }, \"Yes\")));\n  };\n\n  var deleteProduct = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var res;\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return fetch(\"\".concat(baseUrl, \"/api/product/\").concat(product._id), {\n                method: \"DELETE\"\n              });\n\n            case 2:\n              res = _context.sent;\n              _context.next = 5;\n              return res.json();\n\n            case 5:\n              router.push('/');\n\n            case 6:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function deleteProduct() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var AddToCart = /*#__PURE__*/function () {\n    var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var res, res2;\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return fetch(\"\".concat(baseUrl, \"/api/cart\"), {\n                method: \"PUT\",\n                headers: {\n                  \"Content-Type\": \"application/json\",\n                  \"Authorization\": cookie.token\n                },\n                body: JSON.stringify({\n                  quantity: quantity,\n                  productId: product._id\n                })\n              });\n\n            case 2:\n              res = _context2.sent;\n              _context2.next = 5;\n              return res.json();\n\n            case 5:\n              res2 = _context2.sent;\n\n              if (res2.error) {\n                M.toast({\n                  html: error,\n                  classes: \"red\"\n                });\n                cookie2.remove(\"user\");\n                cookie2.remove(\"token\");\n                router.push('/login');\n              }\n\n              M.toast({\n                html: res2.message,\n                classes: \"green\"\n              });\n\n            case 8:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function AddToCart() {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n\n  return __jsx(\"div\", {\n    className: \"container center-align\"\n  }, __jsx(\"h3\", null, product.name), __jsx(\"img\", {\n    src: product.mediaUrl,\n    style: {\n      width: '30%'\n    }\n  }), __jsx(\"h5\", null, \"RS \", product.price), __jsx(\"input\", {\n    type: \"number\",\n    style: {\n      width: \"400px\",\n      margin: \"10px\"\n    },\n    min: \"1\",\n    value: quantity,\n    onChange: function onChange(e) {\n      return setQuantity(Number(e.target.value));\n    },\n    placeholder: \"Qunatity\"\n  }), user ? __jsx(\"button\", {\n    className: \"btn waves-effect waves-light #1565c0 blue darken-3\",\n    onClick: function onClick() {\n      return AddToCart();\n    }\n  }, \"Add\", __jsx(\"i\", {\n    className: \"material-icons right\"\n  }, \"add\")) : __jsx(\"button\", {\n    className: \"btn waves-effect waves-light #1565c0 blue darken-3\",\n    onClick: function onClick() {\n      return router.push('/login');\n    }\n  }, \"Login To Add\", __jsx(\"i\", {\n    className: \"material-icons right\"\n  }, \"add\")), __jsx(\"p\", {\n    className: \"left-align\"\n  }, product.description), user.role != 'user' && __jsx(\"button\", null, __jsx(\"i\", null)), getModal());\n};\n\nexport var __N_SSG = true;\nexport default Product;","map":null,"metadata":{},"sourceType":"module"}