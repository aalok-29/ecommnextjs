{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\nimport { useRouter } from 'next/router';\nimport baseUrl from '../../helpers/baseUrl';\nimport { useRef, useEffect, useState } from 'react';\nimport { parseCookies } from 'nookies';\nimport cookie2 from 'js-cookie';\n\nconst Product = ({\n  product\n}) => {\n  const {\n    0: quantity,\n    1: setQuantity\n  } = useState(1);\n  const router = useRouter();\n  const modalRef = useRef(null);\n  const cookie = parseCookies();\n  const user = cookie.user ? JSON.parse(cookie.user) : \"\";\n  useEffect(() => {\n    M.Modal.init(modalRef.current);\n  }, []);\n\n  if (router.isFallback) {\n    return __jsx(\"h3\", null, \"loading...\");\n  }\n\n  const getModal = () => {\n    return __jsx(\"div\", {\n      id: \"modal1\",\n      className: \"modal\",\n      ref: modalRef\n    }, __jsx(\"div\", {\n      className: \"modal-content\"\n    }, __jsx(\"h4\", null, product.name), __jsx(\"p\", null, \"Are you sure you want to delete this\")), __jsx(\"div\", {\n      className: \"modal-footer\"\n    }, __jsx(\"button\", {\n      className: \"btn waves-effect waves-light #1565c0 blue darken-3\"\n    }, \"cancel\"), __jsx(\"button\", {\n      className: \"btn waves-effect waves-light #c62828 red darken-3\",\n      onClick: () => deleteProduct()\n    }, \"Yes\")));\n  };\n\n  const deleteProduct = async () => {\n    const res = await fetch(`${baseUrl}/api/product/${product._id}`, {\n      method: \"DELETE\"\n    });\n    await res.json();\n    router.push('/');\n  };\n\n  const AddToCart = async () => {\n    const res = await fetch(`${baseUrl}/api/cart`, {\n      method: \"PUT\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        \"Authorization\": cookie.token\n      },\n      body: JSON.stringify({\n        quantity,\n        productId: product._id\n      })\n    });\n    const res2 = await res.json();\n\n    if (res2.error) {\n      M.toast({\n        html: error,\n        classes: \"red\"\n      });\n      cookie2.remove(\"user\");\n      cookie2.remove(\"token\");\n      router.push('/login');\n    }\n\n    M.toast({\n      html: res2.message,\n      classes: \"green\"\n    });\n  };\n\n  return __jsx(\"div\", {\n    className: \"container center-align\"\n  }, __jsx(\"h3\", null, product.name), __jsx(\"img\", {\n    src: product.mediaUrl,\n    style: {\n      width: '30%'\n    }\n  }), __jsx(\"h5\", null, \"RS \", product.price), __jsx(\"input\", {\n    type: \"number\",\n    style: {\n      width: \"400px\",\n      margin: \"10px\"\n    },\n    min: \"1\",\n    value: quantity,\n    onChange: e => setQuantity(Number(e.target.value)),\n    placeholder: \"Qunatity\"\n  }), user ? __jsx(\"button\", {\n    className: \"btn waves-effect waves-light #1565c0 blue darken-3\",\n    onClick: () => AddToCart()\n  }, \"Add\", __jsx(\"i\", {\n    className: \"material-icons right\"\n  }, \"add\")) : __jsx(\"button\", {\n    className: \"btn waves-effect waves-light #1565c0 blue darken-3\",\n    onClick: () => router.push('/login')\n  }, \"Login To Add\", __jsx(\"i\", {\n    className: \"material-icons right\"\n  }, \"add\")), __jsx(\"p\", {\n    className: \"left-align\"\n  }, product.description), user.role != 'user' && __jsx(\"button\", null, __jsx(\"i\", null)), getModal());\n};\n\nexport async function getStaticProps({\n  params: {\n    id\n  }\n}) {\n  const res = await fetch(`${baseUrl}/api/product/${id}`);\n  const data = await res.json();\n  return {\n    props: {\n      product: data\n    }\n  };\n}\nexport async function getStaticPaths() {\n  return {\n    paths: [{\n      params: {\n        id: \"5f0f502b9cb9363990f3de6c\"\n      }\n    }],\n    fallback: true\n  };\n}\nexport default Product;","map":null,"metadata":{},"sourceType":"module"}